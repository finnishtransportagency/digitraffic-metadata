{
	"$schema": "http://json-schema.org/draft-07/schema#",
    "javaType" : "fi.livi.digitraffic.tie.external.tloik.ims.jmessage.JsonMessage",
    "$id": "https://raw.githubusercontent.com/tmfg/metadata/master/schema/JSONMessage_0_2_4.json",
	"type": "object",
	"title": "TrafficSituation announcement.",
	"description": "Structural representation of a traffic situation containing its key elements and all the language versions of announcements sent by Finnish Transportation Agency.",
	"properties": {
		"situationId": {
			"type": "string"
		},
		"version": {
			"type": "integer"
		},
		"releaseTime": {
			"type": "string",
			"format": "date-time",
			"description": "Annoucement release time."
		},
		"locationToDisplay": {
			"type": "object",
			"title": "LocationToDisplay schema.",
			"description": "Location to display in ETRS-TM35FIN coordinate format.",
			"properties": {
				"e": {
					"type": "number"
				},
				"n": {
					"type": "number"
				}
			}
		},
		"announcements": {
			"type": "array",
			"title": "Announcements schema.",
			"description": "Contains announcement's different language versions available.",
			"items": {
				"$ref": "#/definitions/traffic-announcement"
			},
			"minItems": 1
		},
		"contact": {
			"type": "object",
			"title": "Contact schema.",
			"description": "Sender's contact information.",
			"properties": {
				"phone": {
					"type": "string",
					"title": "Phone schema."
				},
				"fax": {
					"type": "string",
					"title": "Fax schema."
				},
				"email": {
					"type": "string",
					"title": "Email schema."
				}
			}
		}
	},
	"required": [
		"situationId",
		"version",
		"releaseTime",
		"announcements"
	],
	"definitions": {
		"traffic-announcement": {
			"type": "object",
			"title": "Announcement schema.",
			"properties": {
				"language": {
					"type": "string",
					"enum": ["fi"],
					"title": "Language schema.",
					"description": "Language of the announcement. A subset of ISO 639-1."
				},
				"title": {
					"type": "string",
					"title": "Title schema.",
					"description": "Short description about the situation."
				},
				"location": {
					"$ref": "#/definitions/location"
				},
				"locationDetails": {
					"type": "object",
					"properties": {
						"areaLocation": {
							"$ref": "#/definitions/area-location"
						},
						"roadAddressLocation": {
							"$ref": "#/definitions/road-address-location"
						}
					},
					"maxProperties": 1,
					"minProperties": 1
				},
				"features": {
					"type": "array",
					"title": "Features schema.",
					"items": {
						"type": "string",
						"title": "Feature schema.",
						"description": "Feature describes characteristics and qualities of the situation."
					}
				},
				"comment": {
					"type": "string",
					"title": "Comment schema.",
					"description": "Free comment"
				},
				"timeAndDuration": {
					"type": "object",
					"title": "TimeAndDuration schema.",
					"properties": {
						"startTime": {
							"type": "string",
							"format" : "date-time",
							"title": "StartTime schema.",
							"description": "Start time of the situation."
						},
						"endTime": {
							"type": "string",
							"format" : "date-time",
							"title": "EndTime schema.",
							"description": "End time of the situation. If the end time has been passed, the situation can be assumed to be over. If end time is not given, there will be follow-up announcement about the situation."
						},
						"estimatedDuration": {
							"type": "object",
							"title": "EstimatedDuration schema.",
							"description": "If exact endtime is not known, duration may be estimated",
							"properties": {
								"minimum": {
									"type": "string",
									"title": "Estimated minimum duration using ISO-8601"
								},
								"maximum": {
									"type": "string",
									"title": "Estimated maximum duration using ISO-8601"
								},
								"informal": {
									"type": "string",
									"title": "Informal",
									"description": "Informal description e.g. '1 - 3 hours'."
								}
							},
							"required": [
								"minimum",
								"informal"
							]
						}
					},
					"required": [
						"startTime"
					]
				},
				"additionalInformation": {
					"type": "string",
					"title": "AdditionalInformation schema.",
					"description": "Additional information."
				},
				"sender": {
					"type": "string",
					"title": "Sender schema.",
					"description": "Name of the sender."
				}
			},
			"required": [
				"language",
				"title",
				"sender"
			]
		},
		"location": {
			"type": "object",
			"title": "Location schema",
			"description": "Location of an traffic situation announcement",
			"properties": {
				"countryCode": {
					"type": "integer",
					"title": "Country code",
					"description": "AlertC country code defined by RDS (IEC 62106)"
				},
				"locationTableNumber": {
					"type": "integer",
					"title": "Location table number",
					"description": "AlertC location table number. Country code + location table number fully identifies the table."
				},
				"locationTableVersion": {
					"type": "string",
					"title": "Location table version",
					"description": "AlertC location table version number"
				},
				"description": {
					"type": "string",
					"title": "Location description",
					"description": "Textual representation of the location"
				}
			},
			"required": [
				"countryCode",
				"locationTableNumber",
				"locationTableVersion",
				"description"
			]
		},
		"area-location": {
			"type": "object",
			"title": "Area location",
			"description": "Location consisting of one or more areas.",
			"properties": {
				"areas": {
					"type": "array",
					"items": {
						"type": "object",
						"title": "Area",
						"properties": {
							"name": {
								"type": "string",
								"title": "The name of the area"
							},
							"locationCode": {
								"type": "integer",
								"title": "Location code of the area",
								"description": "Number of the road point in AlertC location table"
							},
							"type": {
								"type": "string",
								"enum": ["municipality", "province", "weather region", "country"],
								"title": "The type of the area"
							}
						},
						"required": [
							"name",
							"locationCode",
							"type"
						]
					}
				}
			},
			"required": [
				"areas"
			]
		},
		"road-address-location": {
			"type": "object",
			"title": "Road address location",
			"description": "Location consisting of a single road point or a road segment between two road points",
			"properties": {
				"primaryPoint": {
					"$ref": "#/definitions/road-point"
				},
				"secondaryPoint": {
					"$ref": "#/definitions/road-point"
				},
				"direction": {
					"type": "string",
					"title": "Direction schema.",
					"description": "Affected road direction.",
					"enum": [
						"unknown",
						"pos",
						"neg",
						"both"
					]
				},
				"directionDescription": {
					"type": "string",
					"title": "DirectionDescription schema.",
					"description": "Human readable description of the affected direction"
				}
			},
			"required": [
				"primaryPoint",
				"direction"
			]
		},
		"road-point": {
			"type": "object",
			"title": "Road point schema",
			"description": "Description of a single road point",
			"properties": {
				"municipality": {
					"type": "string",
					"title": "Municipality schema.",
					"description": "City, town or village."
				},
				"province": {
					"type": "string",
					"title": "Province schema.",
					"description": "Province eq. Satakunta."
				},
				"country": {
					"type": "string",
					"title": "Country schema.",
					"description": "Usually Finland, but may be something else eq. Sweden, Norway, Russia."
				},
				"roadAddress": {
					"type": "object",
					"title": "RoadAddress schema.",
					"description": "Location in road address (road number + number of the road section + distance from the beginning of the road section.",
					"properties": {
						"road": {
							"type": "integer",
							"title": "Road schema.",
							"description": "Number of the road."
						},
						"roadSection": {
							"type": "integer",
							"title": "RoadSection schema.",
							"description": "Number of the road section."
						},
						"distance": {
							"type": "integer",
							"title": "Distance schema.",
							"description": "Distance from the beginning of the road section."
						}
					},
					"required": [
						"road",
						"roadSection",
						"distance"
					]
				},
				"roadName": {
					"type": "string",
					"title": "RoadName schema.",
					"description": "Name of the road where the accident happened."
				},
				"alertCLocation": {
					"type": "object",
					"title": "AlertC location schema",
					"properties": {
						"locationCode": {
							"type": "integer",
							"title": "AlertC location code",
							"description": "Number of the location point in AlertC location table"
						},
						"name": {
							"type": "string",
							"title": "Location point name"
						},
						"distance": {
							"type": "integer",
							"title": "Distance from the road point",
							"description": "Distance of the road point from the AlertC location point"
						}
					},
					"required": [
						"locationCode",
						"name",
						"distance"
					]
				}
			},
			"required": [
				"roadAddress",
				"alertCLocation"
			]
		}
	}
}
